import{r as u,j as e,T as C,P as t,E as ae,C as O,S as z,J as le,H as q,L as oe,M as F,B as Y,F as ce,I as de,K as ue,W as he}from"./index-082a7ee0.js";import{a as E,C as Q}from"./Card-d98dd1f2.js";import{G as x,T as N,a as v,b as pe,c as xe,d as me,e as ge,f as fe,g as je}from"./TableSortLabel-7f049ea0.js";import{T,O as be}from"./TextField-e01313c8.js";import{L as ve}from"./LoadingButton-ce7f91fa.js";import{D as G,a as H,b as B,c as J,C as V,L as ye}from"./label-77515f4e.js";import{C as Ce}from"./Container-aed5469d.js";function X({setClickedTitle:n}){const[r,s]=u.useState({name:"",duration:"",price:"",description:""}),[o,a]=u.useState(null),[c,d]=u.useState(!1),g=h=>{const{name:f,value:j}=h.target;s({...r,[f]:j})},i=async()=>{d(!0);try{const h=localStorage.getItem("token"),f=await E.post("https://nlfgymback-fnbebqhpgkemhwft.centralindia-01.azurewebsites.net/plan",r,{headers:{Authorization:`${h}`}});console.log("Plan added successfully:",f.data),s({name:"",duration:"",price:"",description:""}),a("Plan Added Successfully"),n("All Plans")}catch(h){console.error("Error adding plan:",h),a(h.response.data.error)}finally{d(!1)}};return e.jsxs(x,{columnGap:1,item:!0,xs:!0,zeroMinWidth:!0,spacing:2,m:3,children:[e.jsx("h1",{children:" Add New plan"}),e.jsx(x,{item:!0,xs:12,sm:6,md:6,children:e.jsx(T,{label:"Plan Name",variant:"outlined",fullWidth:!0,name:"name",value:r.name,onChange:g,sx:{mb:2}})}),e.jsx(x,{item:!0,xs:12,sm:6,md:3,children:e.jsx(T,{label:"Duration (in months)",variant:"outlined",fullWidth:!0,name:"duration",value:r.duration,onChange:g,sx:{mb:2}})}),e.jsx(x,{item:!0,xs:12,sm:6,md:3,children:e.jsx(T,{label:"Price",variant:"outlined",fullWidth:!0,name:"price",value:r.price,onChange:g,sx:{mb:2}})}),e.jsx(x,{item:!0,xs:12,sm:6,md:6,children:e.jsx(T,{label:"Description",variant:"outlined",fullWidth:!0,multiline:!0,rows:4,name:"description",value:r.description,onChange:g,sx:{mb:2}})}),e.jsxs(x,{item:!0,xs:12,sm:6,md:3,mx:3,children:[e.jsx(ve,{variant:"contained",color:"primary",onClick:i,loading:c,children:"Add Plan"}),o&&e.jsx(C,{variant:"body2",color:"error",sx:{mt:1},children:o})]})]})}X.propTypes={setClickedTitle:t.func};function Z({query:n}){return e.jsx(N,{children:e.jsx(v,{align:"center",colSpan:6,sx:{py:3},children:e.jsxs(ae,{sx:{textAlign:"center"},children:[e.jsx(C,{variant:"h6",paragraph:!0,children:"Not found"}),e.jsxs(C,{variant:"body2",children:["No results found for Â ",e.jsxs("strong",{children:['"',n,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}Z.propTypes={query:t.string};function ee({isConfirmationEditOpen:n,setConfirmationEditOpen:r,name:s,id:o,description:a,duration:c,price:d,fetchPlans:g}){const[i,h]=u.useState({name:s,duration:c,price:d,description:a}),[f,j]=u.useState(null),y=m=>{const{name:S,value:D}=m.target;h({...i,[S]:D})},w=async()=>{try{const m=localStorage.getItem("token"),S=await E.put(`https://nlfgymback-fnbebqhpgkemhwft.centralindia-01.azurewebsites.net/plan/${o}`,i,{headers:{Authorization:`${m}`}});g(),console.log("Plan edited successfully:",S.data)}catch(m){console.error("Error editing plan:",m),j(m.message)}r(!1)};return e.jsx(e.Fragment,{children:e.jsxs(G,{open:n,onClose:()=>r(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(H,{id:"alert-dialog-title",children:"Edit Plan"}),e.jsx(B,{children:e.jsxs(x,{container:!0,spacing:2,mt:3,children:[e.jsx(x,{item:!0,xs:12,children:e.jsx(T,{label:"Plan Name",variant:"outlined",fullWidth:!0,name:"name",value:i.name,onChange:y,sx:{mb:2}})}),e.jsx(x,{item:!0,xs:12,sm:6,children:e.jsx(T,{label:"Duration (in months)",variant:"outlined",fullWidth:!0,name:"duration",value:i.duration,onChange:y,sx:{mb:2}})}),e.jsx(x,{item:!0,xs:12,sm:6,children:e.jsx(T,{label:"Price",variant:"outlined",fullWidth:!0,name:"price",value:i.price,onChange:y,sx:{mb:2}})}),e.jsx(x,{item:!0,xs:12,children:e.jsx(T,{label:"Description",variant:"outlined",fullWidth:!0,multiline:!0,rows:4,name:"description",value:i.description,onChange:y,sx:{mb:2}})}),e.jsx(x,{item:!0,xs:12,children:f&&e.jsx(C,{variant:"body2",color:"error",children:f})})]})}),e.jsxs(J,{children:[e.jsx(O,{onClick:()=>r(!1),color:"primary",children:"Cancel"}),e.jsx(O,{onClick:w,color:"primary",children:"Edit"})]})]})})}ee.propTypes={setConfirmationEditOpen:t.func.isRequired,isConfirmationEditOpen:t.bool.isRequired,name:t.string.isRequired,duration:t.string.isRequired,price:t.string.isRequired,id:t.string.isRequired,description:t.string.isRequired,fetchPlans:t.func.isRequired};function ne({fetchPlans:n,selected:r,id:s,avatarUrl:o,name:a,description:c,duration:d,price:g,status:i,handleClick:h}){const[f,j]=u.useState(null),[y,w]=u.useState(!1),[m,S]=u.useState(!1),[D,A]=u.useState(!1),I=p=>{j(p.currentTarget)},W=()=>{j(null)},$=()=>{S(!0),j(null)},L=async()=>{w(!1);try{const p=localStorage.getItem("token"),R=await E.delete(`https://nlfgymback-fnbebqhpgkemhwft.centralindia-01.azurewebsites.net/plan/${s}`,{headers:{Authorization:`${p}`}});n(),console.log("Plan deleted successfully:",R.data)}catch(p){console.error("Error deleting plan:",p)}j(null)},M=async()=>{A(!1);try{j(null);const p=localStorage.getItem("token"),R=await E.patch(`https://nlfgymback-fnbebqhpgkemhwft.centralindia-01.azurewebsites.net/plan/${s}/activate`,null,{headers:{Authorization:p}});n(),console.log("Plan activated successfully:",R.data)}catch(p){console.error("Error activating plan:",p)}},U=async()=>{A(!1);try{j(null);const p=localStorage.getItem("token"),R=await E.patch(`https://nlfgymback-fnbebqhpgkemhwft.centralindia-01.azurewebsites.net/plan/${s}/deactivate`,null,{headers:{Authorization:p}});n(),console.log("Plan deactivated successfully:",R.data)}catch(p){console.error("Error deactivating plan:",p)}};return e.jsxs(e.Fragment,{children:[e.jsxs(N,{hover:!0,tabIndex:-1,duration:"checkbox",selected:r,children:[e.jsx(v,{padding:"checkbox",children:e.jsx(V,{disableRipple:!0,checked:r,onChange:h})}),e.jsx(v,{component:"th",scope:"row",padding:"none",children:e.jsx(z,{direction:"row",alignItems:"center",spacing:2,children:e.jsx(C,{variant:"subtitle2",noWrap:!0,children:s})})}),e.jsx(v,{children:a}),e.jsxs(v,{children:[d," Months"]}),e.jsx(v,{children:c}),e.jsx(v,{align:"center",children:g}),e.jsx(v,{children:e.jsx(ye,{color:i==="active"?"success":"error",children:i})}),e.jsx(v,{align:"right",children:e.jsx(le,{onClick:I,children:e.jsx(q,{icon:"eva:more-vertical-fill"})})})]}),e.jsxs(oe,{open:!!f,anchorEl:f,onClose:W,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},children:[e.jsxs(F,{onClick:$,children:[e.jsx(q,{icon:"eva:edit-fill",sx:{mr:2}}),"Edit"]}),e.jsxs(F,{onClick:()=>w(!0),sx:{color:"error.main"},children:[e.jsx(q,{icon:"eva:trash-2-outline",sx:{mr:2}}),"Delete"]}),i==="active"?e.jsxs(F,{onClick:()=>A(!0),children:[e.jsx(q,{icon:"eva:power-outline",sx:{mr:2}}),"Deactivate"]}):e.jsxs(F,{onClick:()=>A(!0),children:[e.jsx(q,{icon:"eva:power-outline",sx:{mr:2}}),"Activate"]})]}),e.jsxs(G,{open:y,onClose:()=>w(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(H,{id:"alert-dialog-title",children:"Confirm Delete"}),e.jsx(B,{children:e.jsxs(C,{variant:"body1",children:["Are you sure you want to delete ",a,"?"]})}),e.jsxs(J,{children:[e.jsx(O,{onClick:()=>w(!1),color:"primary",children:"Cancel"}),e.jsx(O,{onClick:L,color:"error",autoFocus:!0,children:"Delete"})]})]}),e.jsx(te,{open:D,setOpen:A,title:i==="active"?"Confirm Deactivation":"Confirm Activation",content:`Are you sure you want to ${i==="active"?"deactivate":"activate"} ${a}?`,onConfirm:i==="active"?U:M}),e.jsx(ee,{id:s,isConfirmationEditOpen:m,setConfirmationEditOpen:S,name:a,fetchPlans:n,description:c,duration:d,price:g,status:i})]})}ne.propTypes={avatarUrl:t.any,name:t.any,handleClick:t.func,fetchPlans:t.func,price:t.any,id:t.any,description:t.any,duration:t.any,selected:t.any,status:t.string};function te({open:n,setOpen:r,title:s,content:o,onConfirm:a}){const c=()=>{r(!1)},d=()=>{a(),r(!1)};return e.jsxs(G,{open:n,onClose:c,children:[e.jsx(H,{children:s}),e.jsx(B,{children:e.jsx(C,{variant:"body1",children:o})}),e.jsxs(J,{children:[e.jsx(O,{onClick:c,color:"primary",children:"Cancel"}),e.jsx(O,{onClick:d,color:"error",children:"Confirm"})]})]})}te.propTypes={open:t.bool.isRequired,setOpen:t.func.isRequired,title:t.string.isRequired,content:t.string.isRequired,onConfirm:t.func.isRequired};const ke={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function Pe(n,r,s){return n?Math.max(0,(1+n)*r-s):0}function K(n,r,s){return n[s]===null?1:r[s]===null||r[s]<n[s]?-1:r[s]>n[s]?1:0}function we(n,r){return n==="desc"?(s,o)=>K(s,o,r):(s,o)=>-K(s,o,r)}function Se({inputData:n,comparator:r,filterName:s}){const o=n.map((a,c)=>[a,c]);return o.sort((a,c)=>{const d=r(a[0],c[0]);return d!==0?d:a[1]-c[1]}),n=o.map(a=>a[0]),s&&(n=n.filter(a=>a.name.toLowerCase().indexOf(s.toLowerCase())!==-1)),n}function re({order:n,orderBy:r,rowCount:s,headLabel:o,numSelected:a,onRequestSort:c,onSelectAllClick:d}){const g=i=>h=>{c(h,i)};return e.jsx(pe,{children:e.jsxs(N,{children:[e.jsx(v,{padding:"checkbox",children:e.jsx(V,{indeterminate:a>0&&a<s,checked:s>0&&a===s,onChange:d})}),o.map(i=>e.jsx(v,{align:i.align||"left",sortDirection:r===i.id?n:!1,sx:{width:i.width,minWidth:i.minWidth},children:e.jsxs(xe,{hideSortIcon:!0,active:r===i.id,direction:r===i.id?n:"asc",onClick:g(i.id),children:[i.label,r===i.id?e.jsx(Y,{sx:{...ke},children:n==="desc"?"sorted descending":"sorted ascending"}):null]})},i.id))]})})}re.propTypes={order:t.oneOf(["asc","desc"]),orderBy:t.string,rowCount:t.number,headLabel:t.array,numSelected:t.number,onRequestSort:t.func,onSelectAllClick:t.func};function se({emptyRows:n,height:r}){return n?e.jsx(N,{sx:{...r&&{height:r*n}},children:e.jsx(v,{colSpan:9})}):null}se.propTypes={emptyRows:t.number,height:t.number};function ie({numSelected:n,filterName:r,onFilterName:s}){return e.jsx(ce,{sx:{height:96,display:"flex",justifyContent:"space-between",p:o=>o.spacing(0,1,0,3),...n>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:n>0?e.jsxs(C,{component:"div",variant:"subtitle1",children:[n," selected"]}):e.jsx(be,{value:r,onChange:s,placeholder:"Search plan...",startAdornment:e.jsx(de,{position:"start",children:e.jsx(q,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})})})}ie.propTypes={numSelected:t.number,filterName:t.string,onFilterName:t.func};function _({title:n,total:r,icon:s,color:o="primary",sx:a,...c}){return e.jsxs(Q,{component:z,spacing:3,direction:"row",sx:{px:3,py:5,borderRadius:2,...a},...c,children:[s&&e.jsx(Y,{sx:{width:64,height:64},children:s}),e.jsxs(z,{spacing:.5,children:[e.jsx(C,{variant:"h4",children:r}),e.jsx(C,{variant:"subtitle2",sx:{color:"text.disabled"},children:n})]})]})}_.propTypes={color:t.string,icon:t.oneOfType([t.element,t.string]),sx:t.object,title:t.string,total:t.number};function Te(){const[n,r]=u.useState(0),[s,o]=u.useState("All Plans"),[a,c]=u.useState([]),[d,g]=u.useState("asc"),[i,h]=u.useState([]),[f,j]=u.useState("name"),[y,w]=u.useState(""),[m,S]=u.useState(5),D=l=>{o(l)},A=(l,b)=>{b!==""&&(g(f===b&&d==="asc"?"desc":"asc"),j(b))},I=async()=>{try{const l=await E.get("https://nlfgymback-fnbebqhpgkemhwft.centralindia-01.azurewebsites.net/plan");c(l.data),console.log("Error fetcaing plans:",l.data)}catch(l){console.error("Error fetcaing plans:",l)}};u.useEffect(()=>{I()},[s]);const W=l=>{if(l.target.checked){const b=a.map(k=>k.name);h(b);return}h([])},$=(l,b)=>{const k=i.indexOf(b);let P=[];k===-1?P=P.concat(i,b):k===0?P=P.concat(i.slice(1)):k===i.length-1?P=P.concat(i.slice(0,-1)):k>0&&(P=P.concat(i.slice(0,k),i.slice(k+1))),h(P)},L=(l,b)=>{r(b)},M=l=>{r(0),S(parseInt(l.target.value,10))},U=l=>{r(0),w(l.target.value)},p=Se({inputData:a,comparator:we(d,f),filterName:y}),R=!p.length&&!!y;return e.jsxs(Ce,{children:[e.jsx(z,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:e.jsx(C,{variant:"h4",children:"Plans"})}),e.jsxs(x,{container:!0,spacing:3,m:5,gap:4,children:[e.jsx(x,{xs:12,sm:6,md:3,children:e.jsx(_,{total:"All Plans",color:"success",sx:{cursor:"pointer","&:hover":{cursor:"pointer"}},onClick:()=>D("All Plans"),icon:e.jsx("img",{alt:"icon",src:"/assets/icons/glass/ic_glass_bag.png"})})}),e.jsx(x,{xs:12,sm:6,md:3,children:e.jsx(_,{total:"New Plan",color:"info",sx:{cursor:"pointer","&:hover":{cursor:"pointer"}},onClick:()=>D("New Plan"),icon:e.jsx("img",{alt:"icon",src:"/assets/icons/glass/ic_glass_users.png"})})})]}),e.jsxs(Q,{children:[s==="All Plans"&&e.jsxs(e.Fragment,{children:[e.jsx(ie,{numSelected:i.length,filterName:y,onFilterName:U}),e.jsx(ue,{children:e.jsx(me,{sx:{overflow:"unset"},children:e.jsxs(ge,{sx:{minWidth:800},children:[e.jsx(re,{order:d,orderBy:f,rowCount:a.length,numSelected:i.length,onRequestSort:A,onSelectAllClick:W,headLabel:[{id:"_id",label:"Plan Id"},{id:"name",label:"Plan Name"},{id:"duration",label:"Plan Duration (in Months)"},{id:"description",label:"Description"},{id:"price",label:"Price",align:"center"},{id:"isActive",label:"Status"},{id:""}]}),e.jsxs(fe,{children:[p.slice(n*m,n*m+m).map(l=>e.jsx(ne,{fetchPlans:I,id:l._id,name:l.name,duration:l.duration,description:l.description,price:l.price,status:l.isActive?"active":"inactive",avatarUrl:l.avatarUrl,selected:i.indexOf(l.name)!==-1,handleClick:b=>$(b,l.name)},l._id)),e.jsx(se,{height:77,emptyRows:Pe(n,m,a.length)}),R&&e.jsx(Z,{query:y})]})]})})}),e.jsx(je,{page:n,component:"div",count:a.length,rowsPerPage:m,onPageChange:L,rowsPerPageOptions:[5,10,25],onRowsPerPageChange:M})]})," ",s==="New Plan"&&e.jsx(e.Fragment,{children:e.jsx(X,{setClickedTitle:o})})," "]})]})}function Fe(){return e.jsxs(e.Fragment,{children:[e.jsx(he,{children:e.jsx("title",{children:" Plan | GYM "})}),e.jsx(Te,{})]})}export{Fe as default};
