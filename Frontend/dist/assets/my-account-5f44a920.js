import{P as j,r,j as e,B as m,A as E,T as h,W as b,S as C,C as P}from"./index-082a7ee0.js";import{C as f,a as S}from"./Card-d98dd1f2.js";import{C as w,a as G}from"./CardContent-72e27a9a.js";import{C as A}from"./Container-aed5469d.js";import{T as d,C as I}from"./TextField-e01313c8.js";import{C as q,G as t}from"./CardHeader-73823273.js";const k=({userDetails:s})=>{console.log(s),console.log(s),console.log(s),console.log(s),console.log(s);const[a,o]=r.useState({avatar:"/assets/images/avatars/avatar_1.jpg",email:"",country:"USA",jobTitle:"Senior Developer",name:"",timezone:"GMT-5:30"});return r.useEffect(()=>{s&&o({avatar:"/assets/images/avatars/avatar_1.jpg",email:s.email,country:"USA",jobTitle:"Senior Developer",name:s.name,timezone:"GTM-7"})},[s]),console.log("Current User:"),console.log(s),console.log("User State:"),console.log(a),e.jsx(f,{children:e.jsx(w,{children:e.jsxs(m,{sx:{alignItems:"center",display:"flex",flexDirection:"column"},children:[e.jsx(E,{src:a.avatar,sx:{height:80,mb:2,width:80}}),e.jsx(h,{gutterBottom:!0,variant:"h5",children:a.name}),e.jsx(h,{color:"text.secondary",variant:"body2",children:a.email}),e.jsx(h,{color:"text.secondary",variant:"body2",children:s&&s.lastLogin?s.lastLogin:""})]})})})};k.propTypes={userDetails:j.object};const T=({userID:s})=>{const[a,o]=r.useState(""),[n,l]=r.useState(""),[i,u]=r.useState(""),[y,g]=r.useState(""),[x,v]=r.useState(!1),W=async c=>{if(c.preventDefault(),n!==i){g("New passwords do not match.");return}if(window.confirm("Are you sure you want to change your password?")){v(!0);try{const p=localStorage.getItem("token"),z=await S.post("https://nlfgymback-fnbebqhpgkemhwft.centralindia-01.azurewebsites.net/auth/changePassword",{userID:s,oldPassword:a,newPassword:n},{headers:{Authorization:`${p}`}});console.log("Password change successful:",z.data),g("Password changed successfully."),o(""),l(""),u("")}catch(p){console.error("Error changing password:",p.response.data.error),g("Failed to change password. Please try again.")}finally{v(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsx(b,{children:e.jsx("title",{children:"Change Password | GYM"})}),e.jsx(m,{sx:{py:8},children:e.jsx(f,{children:e.jsx(w,{sx:{pt:4},children:e.jsxs(A,{maxWidth:"sm",p:4,children:[e.jsx(h,{variant:"h4",gutterBottom:!0,children:"Change Password"}),e.jsx("form",{onSubmit:W,children:e.jsxs(C,{spacing:2,children:[e.jsx(d,{type:"password",label:"Old Password",variant:"outlined",fullWidth:!0,required:!0,value:a,onChange:c=>o(c.target.value)}),e.jsx(d,{type:"password",label:"New Password",variant:"outlined",fullWidth:!0,required:!0,value:n,onChange:c=>l(c.target.value)}),e.jsx(d,{type:"password",label:"Confirm New Password",variant:"outlined",fullWidth:!0,required:!0,value:i,onChange:c=>u(c.target.value)}),e.jsx(P,{type:"submit",variant:"contained",color:"primary",disabled:x,startIcon:x&&e.jsx(I,{size:20,color:"inherit"}),children:x?"Changing Password...":"Change Password"}),y&&e.jsx("p",{style:{fontSize:"0.8rem",color:"red",marginTop:"8px"},children:y})]})})]})})})})]})};T.propTypes={userID:j.any};const U=({userDetails:s})=>{console.log("edr hi "),console.log(s),console.log(s);const[a,o]=r.useState({name:s.name,phone:s.phone,email:s.email,address:s.address});r.useEffect(()=>{o({name:s.name,phone:s.phone,email:s.email,address:s.address})},[s]);const n=r.useCallback(i=>{o(u=>({...u,[i.target.name]:i.target.value}))},[]),l=r.useCallback(i=>{i.preventDefault()},[]);return e.jsx("form",{autoComplete:"off",noValidate:!0,onSubmit:l,children:e.jsxs(f,{children:[e.jsx(q,{subheader:"Please contact admin if your details are wrong",title:"Profile"}),e.jsx(w,{sx:{pt:0},children:e.jsx(m,{sx:{m:1.5},children:e.jsxs(t,{container:!0,spacing:3,children:[e.jsx(t,{xs:12,md:6,children:e.jsx(d,{fullWidth:!0,label:"Name",name:"name",onChange:n,required:!0,disabled:!0,value:a.name})}),e.jsx(t,{xs:12,md:6,children:e.jsx(d,{fullWidth:!0,label:"Email Address",name:"email",onChange:n,disabled:!0,value:a.email})}),e.jsx(t,{xs:12,md:6,children:e.jsx(d,{fullWidth:!0,label:"phone",name:"phone",onChange:n,disabled:!0,value:a.phone})})]})})}),e.jsx(G,{sx:{justifyContent:"flex-end"},children:e.jsx(P,{variant:"contained",children:"Save details"})})]})})};U.propTypes={userDetails:j.any};const _=()=>{const[s,a]=r.useState(null);return r.useEffect(()=>{(async()=>{try{const n=localStorage.getItem("token"),l=await S.get("https://nlfgymback-fnbebqhpgkemhwft.centralindia-01.azurewebsites.net/auth/userDetails",{headers:{Authorization:`${n}`}});console.log("response"),console.log("response"),console.log("response"),console.log(l.data.user),a(l.data.user)}catch(n){console.error("Error fetching user details:",n)}})()},[]),e.jsxs(e.Fragment,{children:[e.jsx(b,{children:e.jsx("title",{children:"User | GYM"})}),e.jsx(m,{component:"main",sx:{flexGrow:1,py:8},children:e.jsx(A,{maxWidth:"lg",gap:3,children:e.jsxs(C,{spacing:3,children:[e.jsx("div",{children:e.jsx(h,{variant:"h4",children:"Account"})}),e.jsxs("div",{children:[e.jsx(t,{container:!0,spacing:3,children:e.jsx(t,{xs:12,md:6,lg:4,my:3,children:s&&e.jsx(k,{userDetails:s})})}),s&&e.jsx(U,{userDetails:s})]}),e.jsx("div",{children:e.jsx(t,{container:!0,spacing:3,children:e.jsx(t,{xs:12,md:6,lg:4,my:3,children:s&&e.jsx(T,{userID:s._id})})})})]})})})]})};export{_ as default};
